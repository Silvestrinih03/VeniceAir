-- SEQUENCE ID VOOS
CREATE SEQUENCE SEQ_VOOS START WITH 1 INCREMENT BY 1;

-- TRIGGER VOOS
create or replace trigger PREENCHER_ID_VOOS before insert ON VOOS FOR EACH ROW BEGIN :NEW.ID_VOO:=SEQ_VOOS.nextval;END;

-- TABLE VOOS
CREATE TABLE VOOS (
    ID_VOO integer PRIMARY KEY NOT NULL,
    TRECHO integer NOT NULL,
    DATA_PARTIDA date NOT NULL,
    HORA_PARTIDA varchar2(40) NOT NULL,
    HORA_CHEGADA varchar2(40) NOT NULL,
    AEROPORTO_PARTIDA integer NOT NULL,
    AEROPORTO_CHEGADA integer NOT NULL,
    VALOR number(*,2) NOT NULL,
    FOREIGN KEY (TRECHO) REFERENCES TRECHOS(ID_TRECHO),
    FOREIGN KEY (AEROPORTO_PARTIDA) REFERENCES AEROPORTOS(ID_AEROPORTO),
    FOREIGN KEY (AEROPORTO_CHEGADA) REFERENCES AEROPORTOS(ID_AEROPORTO)
);

ALTER TABLE VOOS MODIFY AEROPORTO_PARTIDA integer NOT NULL;
ALTER TABLE VOOS MODIFY AEROPORTO_CHEGADA integer NOT NULL;
ALTER TABLE VOOS MODIFY TRECHO integer NOT NULL;

-- SELECT VOOS
SELECT V.ID_VOO,
       CO.NOME AS CIDADE_ORIGEM,
       CD.NOME AS CIDADE_DESTINO,
       TO_CHAR(V.DATA_PARTIDA, 'DD/MM/YYYY') AS DATA_PARTIDA,
       V.HORA_PARTIDA,
       V.HORA_CHEGADA,
       AP_PARTIDA.SIGLA AS AEROPORTO_PARTIDA,
       AP_CHEGADA.SIGLA AS AEROPORTO_CHEGADA,
       V.VALOR
FROM VOOS V
INNER JOIN TRECHOS T ON V.TRECHO = T.ID_TRECHO
INNER JOIN AEROPORTOS AP_PARTIDA ON V.AEROPORTO_PARTIDA = AP_PARTIDA.ID_AEROPORTO
INNER JOIN AEROPORTOS AP_CHEGADA ON V.AEROPORTO_CHEGADA = AP_CHEGADA.ID_AEROPORTO
INNER JOIN CIDADES CO ON T.CIDADE_ORIGEM = CO.ID_CIDADE
INNER JOIN CIDADES CD ON T.CIDADE_DESTINO = CD.ID_CIDADE;

-- INSERTS APÃ“S CRIAR O TRIGGER
INSERT INTO VOOS (TRECHO, DATA_PARTIDA, HORA_PARTIDA, HORA_CHEGADA, AEROPORTO_PARTIDA, AEROPORTO_CHEGADA, VALOR)
VALUES (2, '24/11/2023', '13:00', '14:45', 7, 1, 850.00);
INSERT INTO VOOS (TRECHO, DATA_PARTIDA, HORA_PARTIDA, HORA_CHEGADA, AEROPORTO_PARTIDA, AEROPORTO_CHEGADA, VALOR)
VALUES (2, '24/11/2023', '19:00', '20:45', 7, 1, 850.00);

INSERT INTO VOOS (TRECHO, DATA_PARTIDA, HORA_PARTIDA, HORA_CHEGADA, AEROPORTO_PARTIDA, AEROPORTO_CHEGADA, VALOR)
VALUES (2, '24/11/2023', '07:00', '08:45', 7, 1, 850.00);

INSERT INTO VOOS (TRECHO, DATA_PARTIDA, HORA_PARTIDA, HORA_CHEGADA, AEROPORTO_PARTIDA, AEROPORTO_CHEGADA, VALOR)
VALUES (6, '02/12/2023', '15:30', '16:35', 1, 2, 850.00);

INSERT INTO VOOS (TRECHO, DATA_PARTIDA, HORA_PARTIDA, HORA_CHEGADA, AEROPORTO_PARTIDA, AEROPORTO_CHEGADA, VALOR)
VALUES (6, '02/12/2023', '20:50', '21:55', 1, 2, 850.00);

INSERT INTO VOOS (TRECHO, DATA_PARTIDA, HORA_PARTIDA, HORA_CHEGADA, AEROPORTO_PARTIDA, AEROPORTO_CHEGADA, VALOR)
VALUES (6, '02/12/2023', '06:50', '07:55', 1, 2, 850.00);

INSERT INTO VOOS (TRECHO, DATA_PARTIDA, HORA_PARTIDA, HORA_CHEGADA, AEROPORTO_PARTIDA, AEROPORTO_CHEGADA, VALOR)
VALUES (3, '22/12/2023', '05:00', '20:15', 4, 9, 850.00);

INSERT INTO VOOS (TRECHO, DATA_PARTIDA, HORA_PARTIDA, HORA_CHEGADA, AEROPORTO_PARTIDA, AEROPORTO_CHEGADA, VALOR)
VALUES (3, '22/12/2023', '21:00', '00:15', 4, 9, 850.00);

INSERT INTO VOOS (TRECHO, DATA_PARTIDA, HORA_PARTIDA, HORA_CHEGADA, AEROPORTO_PARTIDA, AEROPORTO_CHEGADA, VALOR)
VALUES (3, '22/12/2023', '14:00', '17:15', 4, 9, 850.00);

INSERT INTO VOOS (TRECHO, DATA_PARTIDA, HORA_PARTIDA, HORA_CHEGADA, AEROPORTO_PARTIDA, AEROPORTO_CHEGADA, VALOR)
VALUES (9, '14/12/2023', '09:45', '21:30', 14, 1, 2000.00);

INSERT INTO VOOS (TRECHO, DATA_PARTIDA, HORA_PARTIDA, HORA_CHEGADA, AEROPORTO_PARTIDA, AEROPORTO_CHEGADA, VALOR)
VALUES (9, '14/12/2023', '12:30', '00:10', 14, 1, 2000.00);

INSERT INTO VOOS (TRECHO, DATA_PARTIDA, HORA_PARTIDA, HORA_CHEGADA, AEROPORTO_PARTIDA, AEROPORTO_CHEGADA, VALOR)
VALUES (9, '14/12/2023', '20:00', '07:40', 14, 1, 2000.00);

INSERT INTO VOOS (TRECHO, DATA_PARTIDA, HORA_PARTIDA, HORA_CHEGADA, AEROPORTO_PARTIDA, AEROPORTO_CHEGADA, VALOR)
VALUES (4, '16/12/2023', '19:20', '20:55', 3, 8, 850.00);

INSERT INTO VOOS (TRECHO, DATA_PARTIDA, HORA_PARTIDA, HORA_CHEGADA, AEROPORTO_PARTIDA, AEROPORTO_CHEGADA, VALOR)
VALUES (4, '16/12/2023', '11:00', '12:35', 3, 8, 850.00);

INSERT INTO VOOS (TRECHO, DATA_PARTIDA, HORA_PARTIDA, HORA_CHEGADA, AEROPORTO_PARTIDA, AEROPORTO_CHEGADA, VALOR)
VALUES (4, '16/12/2023', '15:00', '16:35', 3, 8, 850.00);

INSERT INTO VOOS (TRECHO, DATA_PARTIDA, HORA_PARTIDA, HORA_CHEGADA, AEROPORTO_PARTIDA, AEROPORTO_CHEGADA, VALOR)
VALUES (1, '07/12/2023', '10:00', '11:15', 1, 6, 850.00);

INSERT INTO VOOS (TRECHO, DATA_PARTIDA, HORA_PARTIDA, HORA_CHEGADA, AEROPORTO_PARTIDA, AEROPORTO_CHEGADA, VALOR)
VALUES (1, '07/12/2023', '20:00', '21:15', 1, 6, 850.00);

INSERT INTO VOOS (TRECHO, DATA_PARTIDA, HORA_PARTIDA, HORA_CHEGADA, AEROPORTO_PARTIDA, AEROPORTO_CHEGADA, VALOR)
VALUES (1, '07/12/2023', '05:00', '06:15', 1, 6, 850.00);

INSERT INTO VOOS (TRECHO, DATA_PARTIDA, HORA_PARTIDA, HORA_CHEGADA, AEROPORTO_PARTIDA, AEROPORTO_CHEGADA, VALOR)
VALUES (7, '23/12/2023', '19:55', '21:00', 1, 3, 850.00);

INSERT INTO VOOS (TRECHO, DATA_PARTIDA, HORA_PARTIDA, HORA_CHEGADA, AEROPORTO_PARTIDA, AEROPORTO_CHEGADA, VALOR)
VALUES (7, '23/12/2023', '08:00', '09:05', 1, 3, 850.00);

INSERT INTO VOOS (TRECHO, DATA_PARTIDA, HORA_PARTIDA, HORA_CHEGADA, AEROPORTO_PARTIDA, AEROPORTO_CHEGADA, VALOR)
VALUES (7, '23/12/2023', '14:00', '15:05', 1, 3, 850.00);

INSERT INTO VOOS (TRECHO, DATA_PARTIDA, HORA_PARTIDA, HORA_CHEGADA, AEROPORTO_PARTIDA, AEROPORTO_CHEGADA, VALOR)
VALUES (5, '20/12/2023', '04:00', '07:20', 10, 1, 850.00);

INSERT INTO VOOS (TRECHO, DATA_PARTIDA, HORA_PARTIDA, HORA_CHEGADA, AEROPORTO_PARTIDA, AEROPORTO_CHEGADA, VALOR)
VALUES (5, '20/12/2023', '21:00', '00:20', 10, 1, 850.00);

INSERT INTO VOOS (TRECHO, DATA_PARTIDA, HORA_PARTIDA, HORA_CHEGADA, AEROPORTO_PARTIDA, AEROPORTO_CHEGADA, VALOR)
VALUES (5, '20/12/2023', '15:15', '18:35', 10, 1, 850.00);

INSERT INTO VOOS (TRECHO, DATA_PARTIDA, HORA_PARTIDA, HORA_CHEGADA, AEROPORTO_PARTIDA, AEROPORTO_CHEGADA, VALOR)
VALUES (8, '09/01/2023', '23:20', '13:45', 1, 16, 2000.00);

INSERT INTO VOOS (TRECHO, DATA_PARTIDA, HORA_PARTIDA, HORA_CHEGADA, AEROPORTO_PARTIDA, AEROPORTO_CHEGADA, VALOR)
VALUES ( 8, '09/01/2023', '01:50', '16:15', 1, 16, 2000.00);

INSERT INTO VOOS (TRECHO, DATA_PARTIDA, HORA_PARTIDA, HORA_CHEGADA, AEROPORTO_PARTIDA, AEROPORTO_CHEGADA, VALOR)
VALUES (8, '09/01/2023', '11:00', '01:25', 1, 16, 2000.00);

INSERT INTO VOOS (TRECHO, DATA_PARTIDA, HORA_PARTIDA, HORA_CHEGADA, AEROPORTO_PARTIDA, AEROPORTO_CHEGADA, VALOR)
VALUES (10, '18/12/2023', '15:20', '17:20', 12, 18, 2000.00);

INSERT INTO VOOS (TRECHO, DATA_PARTIDA, HORA_PARTIDA, HORA_CHEGADA, AEROPORTO_PARTIDA, AEROPORTO_CHEGADA, VALOR)
VALUES (10, '18/12/2023', '04:30', '06:30', 12, 18, 2000.00);

INSERT INTO VOOS (TRECHO, DATA_PARTIDA, HORA_PARTIDA, HORA_CHEGADA, AEROPORTO_PARTIDA, AEROPORTO_CHEGADA, VALOR)
VALUES (10, '18/12/2023', '21:00', '23:00', 12, 18, 2000.00);

INSERT INTO VOOS (TRECHO, DATA_PARTIDA, HORA_PARTIDA, HORA_CHEGADA, AEROPORTO_PARTIDA, AEROPORTO_CHEGADA, VALOR)
VALUES (11, '10/12/2023', '11:00', '17:10', 14, 20, 2000.00);

INSERT INTO VOOS (TRECHO, DATA_PARTIDA, HORA_PARTIDA, HORA_CHEGADA, AEROPORTO_PARTIDA, AEROPORTO_CHEGADA, VALOR)
VALUES (11, '10/12/2023', '18:00', '00:10', 14, 20, 2000.00);

INSERT INTO VOOS (TRECHO, DATA_PARTIDA, HORA_PARTIDA, HORA_CHEGADA, AEROPORTO_PARTIDA, AEROPORTO_CHEGADA, VALOR)
VALUES (11, '10/12/2023', '00:30', '06:40', 14, 20, 2000.00);

INSERT INTO VOOS (TRECHO, DATA_PARTIDA, HORA_PARTIDA, HORA_CHEGADA, AEROPORTO_PARTIDA, AEROPORTO_CHEGADA, VALOR)
VALUES (12, '22/12/2023', '13:45', '19:15', 17, 19, 2000.00);

INSERT INTO VOOS (TRECHO, DATA_PARTIDA, HORA_PARTIDA, HORA_CHEGADA, AEROPORTO_PARTIDA, AEROPORTO_CHEGADA, VALOR)
VALUES (12, '22/12/2023', '23:00', '04:30', 17, 19, 2000.00);

INSERT INTO VOOS (TRECHO, DATA_PARTIDA, HORA_PARTIDA, HORA_CHEGADA, AEROPORTO_PARTIDA, AEROPORTO_CHEGADA, VALOR)
VALUES (13, '14/12/2023', '20:10', '22:15', 15, 13, 2000.00);

INSERT INTO VOOS (TRECHO, DATA_PARTIDA, HORA_PARTIDA, HORA_CHEGADA, AEROPORTO_PARTIDA, AEROPORTO_CHEGADA, VALOR)
VALUES (13, '14/12/2023', '21:00', '23:05', 15, 13, 2000.00);

INSERT INTO VOOS (TRECHO, DATA_PARTIDA, HORA_PARTIDA, HORA_CHEGADA, AEROPORTO_PARTIDA, AEROPORTO_CHEGADA, VALOR)
VALUES (15, '21/12/2023', '01:00', '09:00', 1, 11, 2000.00);

INSERT INTO VOOS (TRECHO, DATA_PARTIDA, HORA_PARTIDA, HORA_CHEGADA, AEROPORTO_PARTIDA, AEROPORTO_CHEGADA, VALOR)
VALUES (15, '21/12/2023', '23:00', '07:00', 1, 11, 2000.00);

INSERT INTO VOOS (TRECHO, DATA_PARTIDA, HORA_PARTIDA, HORA_CHEGADA, AEROPORTO_PARTIDA, AEROPORTO_CHEGADA, VALOR)
VALUES (15, '21/12/2023', '10:00', '18:00', 1, 11, 2000.00);
